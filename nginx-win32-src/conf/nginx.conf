
daemon on;
worker_processes  1;
master_process off;

events {
    worker_connections  1024;
}

http {
    client_body_buffer_size 1024M;
    client_max_body_size 1024M;
    server {
        listen       80;
        server_name  www.zieckey.com;
        
        #ngx_http_memcached_module
        location /mem {
			if ( $uri ~ "^/mem/([0-9A-Za-z_\.]*)$" )
			{
				set $memcached_key "$1";
				memcached_pass 10.16.28.11:32236;
				#memcached_pass localhost:11211;
			}
        }
        
        #ngx_http_dns_module
		location /dns {
            http_dns_pass_post /xxx.html;
        }
        
        location /mergedemo.html {
        	mergedemo_query yyy;
            allow all;
        }
        
        location /a.html {
            allow all;
        }
        
        location /helloworld.html {
        	helloworld_query;
			token_filter "token=xxx token=yyy token=zzz";
			token_filter "token=aaa";
            allow all;
        }

		location /h.php {
        	helloworld_query;
            allow all;
        }
        
        location /list {
            proxy_pass http://hq.sinajs.cn;
            proxy_set_header  Accept-Encoding  "";
        }

		# POST http://localhost:8091/proxyecho
		location /proxyecho {
            proxy_redirect   off;
            proxy_set_header Connection  "";
            proxy_set_header Host        $host;
            proxy_set_header X-Real-IP   $remote_addr;
            proxy_set_header REMOTE-HOST $remote_addr;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            #proxy_pass  http://localhost:8091/echo?remote_addr=$remote_addr&locale_host=$host;
			#proxy_pass  http://localhost:8091;
			proxy_pass  http://10.16.28.17:8091;
        }

		#ngx_http_mytest_module
		#request: http://localhost/subrequest_query?s_sh000001
        location /subrequest_query {
            subrequest_test;
        }
        
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
        
		include       mime.types;
		default_type  application/octet-stream;
    }
}
